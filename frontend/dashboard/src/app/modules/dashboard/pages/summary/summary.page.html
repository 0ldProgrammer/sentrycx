<div class="main-content">
  <div class="container-fluid">
    
    <div class="row">
      <div class="col-lg-3 col-md-6 col-sm-6">
        <div class="card card-stats summary-block block-green">
          <div class="card-header card-header-danger card-header-icon p-0">
            <div class="card-icon" (click)="changeMainFilter('Application:RED')" style="cursor: pointer;">
              <i class="material-icons">apps</i>
            </div><br />
            <!-- <p class="card-category" style="font-size: 12px;font-weight: bold;color: #000;">APPLICATION - Red Flags</p> -->
            <!-- <p class="card-category" style="font-size: 12px;font-weight: bold;color: #000;">APPLICATION</p> -->
            <h4 class="card-title">APPLICATIONS</h4>
            

            <!-- <table class="table card-category">
              <tbody>
                  <tr>
                      <td>SEV 1 </td>
                      <td class="td-actions text-right">
                          <button mat-raised-button type="button" matTooltip="Edit Task" [matTooltipPosition]="'left'" class="btn btn-primary btn-link btn-sm">
                              1
                          </button>
                      </td>
                   </tr>
              </tbody>
        </table> -->
            <!-- <h3 *ngIf="categoryInfo['application']['RED']" class="card-title" style="font-size: 3em;" (click)="changeMainFilter('Application:RED')">{{categoryInfo['application']['RED']}}</h3>
            <h3 *ngIf="!categoryInfo['application']['RED']" class="card-title" style="font-size: 3em;">0</h3> -->
          </div>
          <div class="card-footer">
            <table class="table my-0">
                <tr [ngClass]="{'table-info': (selectedSeverity=='Application:RED')}" (click)="changeMainFilter('Application:RED')">
                  <td class="py-0"><h4>SEV 1</h4></td>
                  <td class="p-0 pull-right"><a class="btn btn-sm mr-2 btn-link text-danger">{{categoryInfo['application']['RED']}}</a></td>
                </tr>
                <tr [ngClass]="{'table-info': (selectedSeverity=='Application:AMBER')}"  class="" (click)="changeMainFilter('Application:AMBER')">
                  <td class="py-0"><h4>SEV 2</h4></td>
                  <td class="p-0 pull-right"><a class="btn btn-sm mr-2 btn-link text-warning">{{ categoryInfo['application']['AMBER'] }}</a></td>
                </tr>
                <tr [ngClass]="{'table-info': (selectedSeverity=='Application:YELLOW')}"  class="" (click)="changeMainFilter('Application:YELLOW')">
                  <td class="py-0"><h4>SEV 3</h4></td>
                  <td class="p-0 pull-right"><a class="btn btn-sm mr-2 btn-link text-yellow">{{categoryInfo['application']['YELLOW']}}</a></td>
                </tr>
            </table>
          </div>
          <!-- <div class="card-footer">
            <button mat-raised-button class="btn btn-sm btn-warning" 
              (click)="changeMainFilter('Application:AMBER')" 
              matBadgeColor="warn"
              [matBadge]="categoryInfo['application']['AMBER']">
              Amber Flags
            </button>
            
            <button mat-raised-button class="btn btn-sm" 
            matBadgeColor="warn"
              style="background-color: #fdd835" 
              (click)="changeMainFilter('Application:YELLOW')"  
              [matBadge]="categoryInfo['application']['YELLOW']"
            >
              Yellow Flags
            </button>
          </div> -->
        </div>
      </div>
      <div class="col-lg-3 col-md-6 col-sm-6">
        <div class="card card-stats summary-block block-pink">
          <div class="card-header card-header-danger card-header-icon">
            <div class="card-icon" (click)="changeMainFilter('Voice:RED')" style="cursor: pointer;">
              <i class="material-icons">record_voice_over</i>
            </div><br />
            <h4 class="card-title">VOICE</h4>
            <!-- <p class="card-category" style="font-size: 12px;font-weight: bold;color: #000;">VOICE - Red Flags</p>
            <h3 *ngIf="categoryInfo['voice']['RED']" class="card-title" style="font-size: 3em;" (click)="changeMainFilter('Voice:RED')">{{categoryInfo['voice']['RED']}}</h3>
            <h3 *ngIf="!categoryInfo['voice']['RED']" class="card-title" style="font-size: 3em;">0</h3> -->
          </div>
          <div class="card-footer">
            <!-- <button mat-raised-button class="btn btn-sm btn-warning" 
              matBadgeColor="warn"
              (click)="changeMainFilter('Voice:AMBER')" 
              [matBadge]="categoryInfo['voice']['YELLOW']">
              Amber Flags
            </button>
            
            <button mat-raised-button class="btn btn-sm" style="background-color: #fdd835" 
              matBadgeColor="warn"
              (click)="changeMainFilter('Voice:YELLOW')" 
              [matBadge]="categoryInfo['voice']['YELLOW']">
              Yellow Flags
            </button> -->
            <table class="table my-0">
              <tr  [ngClass]="{'table-info': (selectedSeverity=='Voice:RED')}" (click)="changeMainFilter('Voice:RED')">
                <td class="py-0"><h4>SEV 1</h4></td>
                <td class="p-0 pull-right"><a class="btn btn-sm mr-2 btn-link text-danger">{{categoryInfo['voice']['RED']}}</a></td>
              </tr>
              <tr [ngClass]="{'table-info': (selectedSeverity=='Voice:AMBER')}" (click)="changeMainFilter('Voice:AMBER')">
                <td class="py-0"><h4>SEV 2</h4></td>
                <td class="p-0 pull-right"><a class="btn btn-sm mr-2 btn-link text-warning">{{ categoryInfo['voice']['AMBER'] }}</a></td>
              </tr>
              <tr [ngClass]="{'table-info': (selectedSeverity=='Voice:YELLOW')}" class="" (click)="changeMainFilter('Voice:YELLOW')">
                <td class="py-0"><h4>SEV 3</h4></td>
                <td class="p-0 pull-right"><a class="btn btn-sm mr-2 btn-link text-yellow">{{categoryInfo['voice']['YELLOW']}}</a></td>
              </tr>
          </table>
          </div>
        </div>
      </div>
      <div class="col-lg-3 col-md-6 col-sm-6">
        <div class="card card-stats summary-block block-orange">
          <div class="card-header card-header-danger card-header-icon">
            <div class="card-icon" (click)="changeMainFilter('Network:RED')" style="cursor: pointer;">
              <i class="material-icons">network_cell</i>
            </div><br />
            <h4 class="card-title">NETWORK</h4>
            <!-- <p class="card-category" style="font-size: 12px;font-weight: bold;color: #000;">NETWORK - Red Flags</p>
            <h3 *ngIf="categoryInfo['network']['RED']" class="card-title" style="font-size: 3em;" (click)="changeMainFilter('Network:RED')">{{categoryInfo['network']['RED']}}</h3>
            <h3 *ngIf="!categoryInfo['network']['RED']" class="card-title" style="font-size: 3em;">0</h3> -->
          </div>
          <div class="card-footer">
            <table class="table my-0">
              <tr [ngClass]="{'table-info': (selectedSeverity=='Network:RED')}" (click)="changeMainFilter('Network:RED')">
                <td class="py-0"><h4>SEV 1</h4></td>
                <td class="p-0 pull-right"><a class="btn btn-sm mr-2 btn-link text-danger">{{categoryInfo['network']['RED']}}</a></td>
              </tr>
              <tr [ngClass]="{'table-info': (selectedSeverity=='Network:AMBER')}" (click)="changeMainFilter('Network:AMBER')">
                <td class="py-0"><h4>SEV 2</h4></td>
                <td class="p-0 pull-right"><a class="btn btn-sm mr-2 btn-link text-warning">{{ categoryInfo['network']['AMBER'] }}</a></td>
              </tr>
              <tr [ngClass]="{'table-info': (selectedSeverity=='Network:YELLOW')}" class="" (click)="changeMainFilter('Network:YELLOW')">
                <td class="py-0"><h4>SEV 3</h4></td>
                <td class="p-0 pull-right"><a class="btn btn-sm mr-2 btn-link text-yellow">{{categoryInfo['network']['YELLOW']}}</a></td>
              </tr>
          </table>
            <!-- <button mat-raised-button class="btn btn-sm btn-warning" (click)="changeMainFilter('Network:AMBER')" 
              matBadgeColor="warn"
              [matBadge]="categoryInfo['network']['YELLOW']">
              Amber Flags
            </button>
            
            <button mat-raised-button class="btn btn-sm" style="background-color: #fdd835" (click)="changeMainFilter('Application:YELLOW')" 
              matBadgeColor="warn"
              [matBadge]="categoryInfo['network']['YELLOW']">
              Yellow Flags
            </button> -->
          </div>
        </div>
      </div><!--/.row-->
    </div>

    <div class="card">
      <div class="card-header card-header-icon" [ngClass]="cardHeadersClass['accounts']">
        <div class="card-icon" [ngClass]="blinkIcon">
          <i class="material-icons">warning</i>
        </div>
        <h4 class="card-title ">Accounts

          <button *ngIf="searchParams" mat-raised-button class="btn btn-warning pull-right btn-sm"  matBadgeColor="accent" matBadge="!" data-toggle="modal" data-target="#filterModal" >
            <i class="material-icons">search</i> 
          </button>

          <button *ngIf="!searchParams" mat-raised-button class="btn btn-warning pull-right btn-sm" data-toggle="modal" data-target="#filterModal"   >
            <i class="material-icons">search</i> 
          </button>

          <button mat-raised-button class="btn btn-info pull-right btn-sm" (click)="resetToBase()">
            <span class="btn-label">
              <i class="material-icons">refresh</i>
            </span>
          </button>
        </h4>

        <!-- <mat-chip-list aria-label="Fish selection" > 
          <mat-chip *ngIf="filterTag && filterTag.split(':')[1] == 'RED'"   
            style="background-color: #f33527;"
            (click)="resetToBase()" selected>{{ filterTag.split(":")[0] }} <i class="material-icons">close</i></mat-chip>
          <mat-chip *ngIf="filterTag && filterTag.split(':')[1] == 'AMBER'"  
            style="background-color: #ff9800"
            (click)="resetToBase()" selected>{{ filterTag.split(":")[0] }} <i class="material-icons">close</i></mat-chip>
          <mat-chip *ngIf="filterTag && filterTag.split(':')[1] == 'YELLOW'"  
            style="background-color: #fdd835" 
            (click)="resetToBase()"selected>{{ filterTag.split(":")[0] }} <i class="material-icons">close</i></mat-chip>
        </mat-chip-list> -->

      </div>
        <div class="card-body">
          <!-- TODO : Convert this into component -->
          
            <div class="table-responsive">
              <table class="table table-hover">
                <thead class="text-primary thead-md">
                    <tr>
                      <th class="text-left">Accounts</th>
                      <th>Total Logins</th>
                      <th>Applications</th>
                      <th>Voice</th>
                      <th>Network</th>
                      <th>Total Alerts</th>
                      <th></th>
                    </tr>
                </thead>
                <tbody>
                  <ng-container *ngFor="let affectedItem of affectedSummary">
                    <!-- TODO : Convert this tr into component to be reused by breakdown-->
                    <tr  
                      [class.table-info]="selectedAccount === affectedItem.account"
                      (click)="loadFlagsByAccount( affectedItem.account )">
                      <td class="text-left">{{ affectedItem.account }}</td>
                      <td>{{ affectedItem.logins }}</td>
                      <td [ngClass]="{'text-danger': (affectedItem['application']['percentage'] >= 10)}">
                        {{ affectedItem['application']['alert'] }} ({{ affectedItem['application']['percentage'] | number: '1.0-0' }}%) 
                      </td>
                      <td [ngClass]="{'text-danger': (affectedItem['voice']['percentage'] >= 10)}">
                        {{ affectedItem['voice']['alert'] }} ({{ affectedItem['voice']['percentage'] | number: '1.0-0'}}%)
                      </td>
                      <td [ngClass]="{'text-danger': (affectedItem['network']['percentage'] >= 10)}">
                        {{ affectedItem['network']['alert'] }} ({{ affectedItem['network']['percentage'] | number: '1.0-0' }}%) 
                      </td>
                      <td>{{ affectedItem.alerts }}</td>
                      <td class="td-actions">
                        <a *ngIf="!affectedItem['url']" 
                          (click)="viewPlaybook(affectedItem.account)"
                          target="_blank" matTooltip="Playbook(Excel)" 
                          type="button" mat-raised-button 
                          class="btn  btn-fab btn-sm btn-link" >
                          <i class="material-icons">contact_page</i>
                        </a>

                        <a *ngIf="affectedItem['url']" target="_blank" matTooltip="Playbook(External)" attr.href="{{affectedItem['url'] }}" mat-raised-button class="btn  btn-sm btn-fab btn-link">
                          <i class="material-icons">contact_page</i>
                        </a>

                        <a target="_blank" matTooltip="CM & Outage History" href="https://support.concentrix.com/arsys" mat-raised-button class="btn btn-sm  btn-fab btn-link">
                          <i class="material-icons">history</i>
                        </a>

                        <a (click)="changeStatusByBatch({account : affectedItem.account, old_unresolved : 0}, 'Acknowledge'); "
                          target="_blank" matTooltip="Batch Acknowledge" 
                          type="button" mat-raised-button 
                          class="btn btn-fab btn-sm btn-link" >
                          <i class="material-icons">spellcheck</i>
                        </a>

                        <a (click)="changeStatusByBatch({account : affectedItem.account, old_unresolved : 0}, 'For Confirmation'); " 
                          target="_blank" matTooltip="Batch Resolve" 
                          type="button" mat-raised-button 
                          class="btn btn-fab btn-sm btn-link" >
                          <i class="material-icons">thumb_up</i>
                        </a>

                        <a (click)="loadHostfile( affectedItem.account )"
                          target="_blank" matTooltip="Hostfile"  
                          mat-raised-button class="btn btn-sm btn-fab btn-link">
                          <i class="material-icons">insert_drive_file</i>
                        </a>

                      </td>
                    </tr>
                    <ng-container *ngIf="selectedAccount === affectedItem.account">
                      <tr *ngFor="let breakdownItem of affectedBreakdown[affectedItem.account]">
                        <td class="text-left pl-4">{{ breakdownItem['country'] }}</td>
                        <td>{{ breakdownItem.logins }}</td>
                        <td [ngClass]="{'text-danger': (breakdownItem['application']['percentage'] >= 10)}">
                          {{ breakdownItem['application']['alert'] }} ({{ breakdownItem['application']['percentage'] | number: '1.0-0' }}%) 
                        </td>
                        <td [ngClass]="{'text-danger': (breakdownItem['voice']['percentage'] >= 10)}">
                          {{ breakdownItem['voice']['alert'] }} ({{ breakdownItem['voice']['percentage'] | number: '1.0-0'}}%)
                        </td>
                        <td [ngClass]="{'text-danger': (breakdownItem['network']['percentage'] >= 10)}">
                          {{ breakdownItem['network']['alert'] }} ({{ breakdownItem['network']['percentage'] | number: '1.0-0' }}%) 
                        </td>
                        <td>{{ breakdownItem.alerts }}</td>
                        <td></td>
                      </tr>
                    </ng-container>

                  </ng-container>
                  
                  <tr *ngIf="totalSummary != null">
                    <td class="text-left "><b>TOTAL</b></td>
                     <td><b>{{ totalSummary.logins }}</b></td>
                    <td [ngClass]="{'text-danger': (totalSummary['application']['percentage'] >= 10)}">
                      <b>
                        {{ totalSummary['application']['alert'] }} ({{ totalSummary['application']['percentage'] | number: '1.0-0' }}%) 
                      </b>
                    </td>
                    
                    <td [ngClass]="{'text-danger': (totalSummary['voice']['percentage'] >= 10)}">
                      <b>
                        {{ totalSummary['voice']['alert'] }} ({{ totalSummary['voice']['percentage'] | number: '1.0-0'}}%)
                      </b>
                    </td>
                    <td [ngClass]="{'text-danger': (totalSummary['network']['percentage'] >= 10)}">
                      <b>
                        {{ totalSummary['network']['alert'] }} ({{ totalSummary['network']['percentage'] | number: '1.0-0' }}%) 
                      </b>
                    </td>
                    <td><b>{{ totalSummary.alerts }}</b></td>
                    <td></td>
                  </tr>
                  
                  <tr *ngIf="affectedSummary.length == 0">
                    <td colspan="7" class="text-center">
                      <h5 style="padding-top: 6px;">No data found</h5>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
        </div>
    </div>


    <div class="col-md-12">
      <div class="card card-plain">
        <div class="card-header card-header-icon" [ngClass]="cardHeadersClass['accounts']">
          <div class="card-icon">
            <i class="material-icons">support_agent</i>
          </div>
          
          <h4 class="card-title mt-0"> Agents
            <div class="generate-report">
              <button mat-raised-button 
                [mdePopoverTriggerFor]="dropdownReportPopover" class="pre-wrap btn-sm btn btn-primary pull-right"
                mdePopoverTriggerOn="click" #popoverTrigger="mdePopoverTrigger">
                <i class="material-icons">import_export</i> 
              </button>
            </div>
            <div *ngIf="hasFlagFilttered">

              <button (click)="changeStatusByBatch(flagFilters, 'For Confirmation')"
                mat-raised-button matTooltip="Batch Resolve" 
                class="btn btn-primary pull-right btn-sm " >
                <i class="material-icons">thumb_up</i> 
              </button>

              <button (click)="changeStatusByBatch(flagFilters, 'Acknowledge')"
                mat-raised-button matTooltip="Batch Acknowledge" 
                class="btn btn-danger pull-right btn-sm "  >
                <i class="material-icons">spellcheck</i> 
              </button>

              <button mat-raised-button class="btn btn-warning pull-right btn-sm" 
                matTooltip="Filter"
                matBadgeColor="accent" matBadge="!" 
                data-toggle="modal" data-target="#flagFilterModal" >
                <i class="material-icons">search</i> 
              </button>
            </div><!--.button-container-->

            <div *ngIf="!hasFlagFilttered">

              <button  mat-raised-button matTooltip="Batch Resolve(No Filter Selected)" class="btn btn-light pull-right btn-sm" >
                <i class="material-icons">thumb_up</i> 
              </button>

              <button  mat-raised-button matTooltip="Batch Acknowledge(No Filter Selected)" class="btn btn-light pull-right btn-sm " >
                <i class="material-icons">spellcheck</i> 
              </button>

              <button  mat-raised-button class="btn btn-warning pull-right btn-sm" data-toggle="modal" data-target="#flagFilterModal" matTooltip="Filter"  >
                <i class="material-icons">search</i> 

              </button>
            </div>

            <dropdown data-title='
              <span class="btn-label">
                <i class="material-icons">view_column</i>
              </span>
              '
              [data-options]="flagColumns"
              [data-default]="flagSelectedColumns"
              [data-closeonclick]="false"
              data-type="MULTIPLE"
              class="pull-right"
              (onChange)="onDynamicColumnChange($event)"
            ></dropdown>

          </h4>
          <!-- <dropdown [data-title]="agentStatusTitle"
            [data-options]="agentStatusOptions"
            [data-default]="['online']"
            data-type="SINGLE"
            (onChange)="onAgentStatusFilter($event)"
          ></dropdown> -->


          <mat-chip-list aria-label="Fish selection">
            <mat-chip *ngIf="flagFilters['category']" color="accent" selected>{{ flagFilters['category'] | titlecase }}</mat-chip>
            <mat-chip *ngIf="flagFilters['account']"  color="primary" selected>{{ flagFilters['account'] }}</mat-chip>
          </mat-chip-list>

        </div>
          <div class="card-body">
            <div class="table-responsive">
              <table class="table table-striped table-hover ">
                  <thead class="thead-md">
                    <tr>
                      <th *ngIf="flagSelectedColumns | contains:'ref_no'">
                        <sort-header class="text-left" 
                        data-field='ref_no'
                        data-name='Reference No'
                        [data-selected]="sortedField == 'ref_no' "
                        (onSort)="sortFlag($event)"
                        ></sort-header>
                      </th>
                      <th>
                          <sort-header class="text-left"
                          data-field='agent_name'
                          data-name='Agent Name'
                         [data-selected]="sortedField == 'agent_name' "
                         (onSort)="sortFlag($event)"
                        ></sort-header>
                      </th>
                      
                      <ng-container  *ngFor="let header of flagHeaders">
                        <th *ngIf="flagSelectedColumns | contains:header.field"> 
                          <sort-header
                          class="text-left"
                          [data-field]='header.field'
                          [data-name]='header.name'
                         [data-selected]="sortedField == header.field"
                         (onSort)="sortFlag($event)"
                        ></sort-header>
                        </th>
                      </ng-container>
                      <th *ngIf="flagSelectedColumns | contains:'media_device'"><i class="material-icons">headset</i></th>
                      <th *ngIf="flagSelectedColumns | contains:'media_device'"><i class="material-icons">mic</i></th>
                      <th *ngIf="flagSelectedColumns | contains:'media_device'"><i class="material-icons" >camera_alt</i></th>
                      <th>Action</th>
                      <th>More Details</th>
                      <th></th>
                    </tr>
                  </thead>
                <tbody>
                  <tr *ngIf="flags.length == 0">
                    <td colspan="100%" class="text-center" style="padding: 6px;">No Reported issues from logged in agents.</td>
                  </tr>
                  <tr *ngFor="let issue of flags">
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'ref_no'">{{ issue.ref_no }}</td>
                    <td class="text-left">
                      <popover *ngIf="issue.mtr" class="mtr-table"
                        [data-text]="issue.agent_name | titlecase" 
                        [data-header]="'MTR Result : ' + issue.agent_name | titlecase"
                        [data-content]="issue.mtr"
                      ></popover>
                      <popover *ngIf="!issue.mtr"
                        [data-text]="issue.agent_name | titlecase" 
                        [data-header]="'MTR Result : ' + issue.agent_name | titlecase"
                        data-content="No MTR recorded for this issue."
                      ></popover>
                    </td>
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'host_name'">{{ issue.host_name }}</td>
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'code'">{{ issue.code_name }}</td>
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'category'">{{ issue.category_name | uppercase }}</td>
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'connection'">{{ issue.connection_type | default:'-' }}</td>
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'agent' ">{{ issue.agent }}</td>

                    
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'location'">{{ issue.location }}</td>
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'account'">{{ issue.account }}</td>
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'status_info'">{{ issue.status_info }}</td>
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'mtr_highest_avg'">{{ issue.mtr_highest_avg }} </td>
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'mtr_highest_loss'">{{ issue.mtr_highest_loss }}</td>

                    <!--! Display only based on filter -->
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'VLAN'">{{ issue.VLAN }} </td>
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'DNS_1'">{{ issue.DNS_1 }} </td>
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'DNS_2'">{{ issue.DNS_2 }}</td>
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'subnet'">{{ issue.subnet }} </td>
                    <!-- <td class="text-left" *ngIf="flagSelectedColumns | contains:'ISP'">{{ issue.ISP }}</td> -->
                    <td *ngIf="flagSelectedColumns | contains:'ISP'" class="text-left" >
                      <div *ngIf="issue.ISP == issue.isp_fullname">
                        {{ issue.ISP }}
                      </div>
                      <div *ngIf="issue.ISP != issue.isp_fullname" matTooltip="{{issue.isp_fullname}}" 
                        matTooltipPosition="after" 
                        matTooltipClass="tooltip-css">
                        {{ issue.ISP }}
                      </div>
                    </td>
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'download_speed'">
                      {{ issue.download_speed ? issue.download_speed : '-' }} {{ issue.download_speed && issue.download_speed !== ' - ' ? 'Mbps' : '' }}
                    </td>
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'upload_speed'">
                      {{ issue.upload_speed ? issue.upload_speed : '-' }} {{ issue.upload_speed && issue.upload_speed !== ' - ' ? 'Mbps' : '' }}
                    </td>
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'average_latency'">{{ issue.average_latency }}</td>
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'packet_loss'">{{ issue.packet_loss | number : '1.2-2' }}%</td>
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'jitter'">{{ issue.jitter }}</td>
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'mos'" [ngClass]="issue.mos | mosRate">{{ issue.mos | number : '1.2-2'}} </td>
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'timestamp_submitted'">{{ issue.timestamp_submitted | dateAgo }}</td>
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'date_created'">{{ issue.date_created | timezone }}</td>
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'lob'">{{ issue.lob }}</td>
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'programme_msa'">{{ issue.programme_msa }}</td>
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'job_profile'">{{ issue.job_profile }}</td>
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'supervisor_email_id'">{{ issue.supervisor_email_id }}</td>
                    <td class="text-left" *ngIf="flagSelectedColumns | contains:'supervisor_full_name'">{{ issue.supervisor_full_name }}</td>
                    <td *ngIf="flagSelectedColumns | contains:'media_device'"> 
                      <i class="material-icons text-success" *ngIf="issue.audio == true" text-success>check_circle</i>
                      <i class="material-icons text-danger" *ngIf="issue.audio == false" text-danger>block</i>
                      <i *ngIf="issue.audio === null" text-warning>-</i>
                    </td>
                    <td *ngIf="flagSelectedColumns | contains:'media_device'">  
                      <i class="material-icons text-success" *ngIf="issue.mic == true" text-success>check_circle</i>
                      <i class="material-icons text-danger" *ngIf="issue.mic == false" text-danger>block</i>
                      <i  *ngIf="issue.mic === null" text-warning>-</i>
                    </td>
                    <td *ngIf="flagSelectedColumns | contains:'media_device'"> 
                      <i class="material-icons text-success" *ngIf="issue.video == true" text-success>check_circle</i>
                      <i class="material-icons text-danger" *ngIf="issue.video == false" text-danger>block</i>
                      <i *ngIf="issue.video === null" text-warning>-</i>
                    </td>
                    
                    <td>
                      <button *ngIf="issue.status_info == 'Inquiry' "
                      (click)="changeStatus(issue.id, 'Acknowledge')"
                      mat-raised-button class="btn btn-warning btn-sm">Acknowledge</button>
                      <button *ngIf="issue.status_info == 'Acknowledge'" 
                        (click)="changeStatus(issue.id, 'For Confirmation')"
                        mat-raised-button class="btn btn-success btn-sm">Resolve</button>

                    </td>
                    <td class="td-actions text-right">
                      <!-- Web MTR modal -->
                      <a *ngIf="issue.is_active" matTooltip="Viewing WEB MTR" 
                        matTooltipPosition="before" 
                        matTooltipClass="tooltip-css" 
                        class="waves-effect waves-light btn btn-warning btn-sm btn-link" 
                        (click)="!!loadWebMTR(issue.connection_id)">
                          <i class="material-icons left">network_cell</i>
                      </a>

                      <!-- Remote Desktop Button -->
                      <a *ngIf="issue.is_active" matTooltip="ZOHO" 
                        matTooltipPosition="before" 
                        class="waves-effect waves-light btn btn-danger btn-sm btn-link" 
                        target="_blank" [routerLink]="['/integrations/zoho']" 
                        [queryParams]="{ state : issue.worker_id }">
                          <i class="material-icons left">screen_share</i>
                      </a>

                      <!-- Web MTR Button -->
                      <a *ngIf="!issue.is_active" matTooltip="Agent is offline" 
                        matTooltipPosition="before" 
                        matTooltipClass="tooltip-css" 
                        class="waves-effect waves-light btn btn-light btn-sm btn-link" 
                        >
                          <i class="material-icons left">network_cell</i>
                      </a>

                      <!-- Remote Desktop Button -->
                      <a *ngIf="!issue.is_active" matTooltip="Agent is Offline" 
                        matTooltipPosition="before" 
                        matTooltipClass="tooltip-css" 
                        class="waves-effect waves-light btn btn-light btn-sm btn-link" 
                        >
                          <i class="material-icons left">screen_share</i>
                      </a>

                      <!-- Agent Profile Button -->
                      <!-- <a matTooltip="Agent Profile"  matTooltipPosition="before" 
                      (click)="loadAgentProfile(issue.worker_id)"
                      class="waves-effect waves-light btn btn-info btn-sm btn-link"  >
                        <i class="material-icons left">account_box</i>
                      </a> -->
                      <popover-agent (onClick)="loadAgentProfile($event)"
                      [data-agent-id]="issue.worker_id"
                      [profile]="issue">
                    </popover-agent>

                      <!-- Workstation Profile Button -->
                      <popover-workstation *ngIf="issue.station_id " [data-text]="''" 
                        [data-agent]="issue"
                        (onClick)="loadWorkstation($event)"
                      ></popover-workstation>

                      <a *ngIf="!issue.station_id" matTooltip="No Workstation Profile" 
                        matTooltipPosition="before" 
                        matTooltipClass="tooltip-css" 
                        class="waves-effect waves-light btn btn-light btn-sm btn-link" 
                        >
                          <i class="material-icons left">computer</i>
                      </a>

                      <!-- Application Monitoring Button : DISABLED -->
                      <!-- <a *ngIf="!issue.has_threshold" matTooltip="Agent Applications" 
                        matTooltipPosition="before" 
                        (click)="loadAplicationMonitoring(issue)"
                        class="waves-effect waves-light btn btn-light btn-sm btn-link" 
                      >
                          <i class="material-icons left">apps</i>
                      </a> -->

                      <!-- Application Monitoring Button  -->
                      <!-- <a *ngIf="issue.has_threshold" matTooltip="Agent Applications" 
                        (click)="loadAplicationMonitoring(issue)"
                        matTooltipPosition="before" 
                        class="waves-effect waves-light btn btn-warning btn-sm btn-link" 
                        matBadgeColor="accent"
                        matBadge="!" >
                          <i class="material-icons left">apps</i>
                      </a> -->
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
      </div>
      <mat-paginator (page)="updatePage($event)"
        [length]="flagPaginate.total"
        [pageSize]="flagPaginate.perPage"
        [pageSizeOptions]="[10, 20, 30, 40, 50]">
      </mat-paginator>
      
      <div class="modal fade" id="filterModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <summary-filter [filterListAccount]="filterOptions.location"
              [filterListAccount]="filterOptions.accounts"
              [filterListCountry]="filterOptions.countries"
              (onSearch)="search($event)"
              (onReset)="reset()"
            ></summary-filter>
      </div>

      <div class="modal fade" id="flagFilterModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <popup-filter [data-filters]="flagFilterOptions['filters']"
              [data-fields]="flagFilterOptions['fields']"
              (onSearch)="searchFlag($event)"
              (onReset)="clearSearchFlag()">
            </popup-filter>
      </div><!--/.modal-->
      <mde-popover #dropdownReportPopover="mdePopover" [mdePopoverOverlapTrigger]="false" [mdeFocusTrapEnabled]="true" [mdePopoverCloseOnClick]="true" mdePopoverTriggerOn="click">
        <mat-card style="max-width: 300px">
            <mat-card-content>
            
            <mat-nav-list>
              <a mat-list-item *ngFor="let item of reportType" (click)="setReport(item.value)">
                {{ item.name }} 
            </a>
            </mat-nav-list>
            </mat-card-content>
        </mat-card>
      </mde-popover>
      

  </div><!--/.container.fluid-->
</div><!--/.main-content-->


<style>
/* I DONT KNOW THE demo.css or styles.css are not working */
.tooltip-inner, .mat-tooltip {
  font-size: 12px;
  font-weight: bold;
  color: #000;a
}

p.card-category {
    font-size: 12px;
    font-weight: bold;
    color: #000;
}
  
</style>
